var ct=Object.defineProperty;var mt=(s,t,i)=>t in s?ct(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var r=(s,t,i)=>(mt(s,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))h(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&h(l)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function h(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();function pt(){const t=document.getElementById("canvas").getContext("2d");return t.imageSmoothingEnabled=!1,t}function U(s,t,i,h,n,o=1,l,m){const[p,w,L,M]=i;s.scale(o,1),s.drawImage(t,p,w,L,M,h*o,n,l??L,m??M),s.setTransform(1,0,0,1,0,0)}var c=(s=>(s.LEFT="left",s.RIGHT="right",s.UP="up",s.DOWN="down",s.LIGHT_PUNCH="lightPunch",s.LIGHT_KICK="lightKick",s.MEDIUM_KICK="mediumKick",s))(c||{});const k=[{keyboard:{[c.LEFT]:"KeyA",[c.RIGHT]:"KeyD",[c.UP]:"KeyW",[c.DOWN]:"KeyS",[c.LIGHT_KICK]:"KeyG",[c.MEDIUM_KICK]:"KeyJ",[c.LIGHT_PUNCH]:"KeyT"}},{keyboard:{[c.LEFT]:"ArrowLeft",[c.RIGHT]:"ArrowRight",[c.UP]:"ArrowUp",[c.DOWN]:"ArrowDown",[c.LIGHT_PUNCH]:"Numpad7",[c.LIGHT_KICK]:"Numpad4",[c.MEDIUM_KICK]:"Numpad6"}}];var E=(s=>(s[s.LEFT=-1]="LEFT",s[s.RIGHT=1]="RIGHT",s))(E||{}),O=(s=>(s.PUNCH="punch",s.KICK="kick",s))(O||{}),S=(s=>(s.LIGHT="light",s.MEDIUM="medium",s))(S||{}),e=(s=>(s.IDLE="idle",s.IDLE_TURN="idleTurn",s.WALK_FORWARDS="walkForwards",s.WALK_BACKWARDS="walkBackwards",s.JUMP_START="jumpStart",s.JUMP_UP="jumpUp",s.JUMP_FORWARDS="jumpForwards",s.JUMP_BACKWARDS="jumpBackwards",s.JUMP_LAND="jumpLand",s.JUMP_ROLL_LAND="jumpRollLand",s.CROUCH="crouch",s.CROUCH_UP="crouchUp",s.CROUCH_DOWN="crouchDown",s.CROUCH_TURN="crouchTurn",s.LIGHT_PUNCH="lightPunch",s.LIGHT_KICK="lightKick",s.MEDIUM_KICK="mediumKick",s.HURT_HEAD_LIGHT="hurtHeadLight",s.HURT_BODY_LIGHT="hurtBodyLight",s.WIN="win",s.LOSE="lose",s))(e||{}),g=(s=>(s.HEAD="head",s.BODY="body",s.FEET="feet",s))(g||{}),I=(s=>(s.RAIDEN="raiden",s["LIU-KANG"]="liu-kang",s))(I||{});const K=new Set,V=new Set,ht=k.map(({keyboard:s})=>Object.values(s)).flat().concat("Enter");function ft(s){ht.includes(s.code)&&(s.preventDefault(),K.add(s.code))}function It(s){ht.includes(s.code)&&(s.preventDefault(),K.delete(s.code),V.delete(s.code))}function gt(){window.addEventListener("keydown",ft),window.addEventListener("keyup",It)}const v=s=>K.has(s);function _(s){return K.has(s)&&!V.has(s)?(V.add(s),!0):!1}const Z=s=>v(k[s].keyboard[c.LEFT]),X=s=>v(k[s].keyboard[c.RIGHT]),H=s=>v(k[s].keyboard[c.UP]),q=s=>v(k[s].keyboard[c.DOWN]),R=(s,t)=>_(k[s].keyboard[t]),W=(s,t)=>t===E.RIGHT?X(s):Z(s),J=(s,t)=>t===E.LEFT?X(s):Z(s),wt=s=>!(Z(s)||X(s)||H(s)||q(s)),C=s=>R(s,c.LIGHT_PUNCH),P=s=>R(s,c.LIGHT_KICK),j=s=>R(s,c.MEDIUM_KICK);class b{constructor(){r(this,"animationTimer",0);r(this,"animationFrame",0);r(this,"frameDelay",0);r(this,"alpha",1);r(this,"fadeIn",!1)}restart(){this.alpha=1,this.fadeIn=!1}update(){this.fadeIn||(this.alpha-=.01,this.alpha<0&&(this.alpha=0,this.fadeIn=!0))}draw(t){t.fillStyle=`rgba(0,0,0, ${this.alpha})`,t.fillRect(0,0,t.canvas.width,t.canvas.height)}}var D=(s=>(s[s.FIRST=0]="FIRST",s[s.SECOND=1]="SECOND",s))(D||{}),f=(s=>(s.MAIN="main",s.GAMEOVER="gameover",s.HEROES="heroes",s))(f||{});class Lt{constructor(){r(this,"image",document.querySelector('img[alt="misc"]'));r(this,"frames",new Map([["background",[4010,1551,320,240]]]));r(this,"fade",new b)}update(){this.fade.fadeIn?_("Enter")&&(u.currentMenu=f.HEROES,u.fighters=[]):this.fade.update()}drawFrame(t,i,h,n,o,l){U(t,this.image,this.frames.get(i),h,n,o,l)}draw(t){this.drawFrame(t,"background",0,0),this.fade.draw(t)}}const Dt=60,$=1e3/Dt;class A{constructor(t,i,h,n=0){r(this,"image");r(this,"frames");r(this,"animation");r(this,"animationTimer",0);r(this,"animationFrame");r(this,"frameDelay");this.image=t,this.frames=new Map(i),this.animation=h,this.animationFrame=n,this.frameDelay=h[this.animationFrame][1]}update(t){t.previous>this.animationTimer+this.frameDelay*$&&(this.animationFrame+=1,this.animationFrame>=this.animation.length&&(this.animationFrame=0),this.frameDelay=this.animation[this.animationFrame][1],this.animationTimer=t.previous)}draw(t,i,h){const[n]=this.animation[this.animationFrame],[o,l,m,p]=this.frames.get(n);t.drawImage(this.image,o,l,m,p,i,h,m,p)}}const z=66,Q=90,a={IDLE:[-16,-92,32,90],JUMP:[-16,-55,32,55],JUMP_UP:[-16,-80,32,80],CROUCH:[-16,-60,32,60],PUNCH:[-5,-92,32,90]},T=135,Et={[S.LIGHT]:{damage:12},[S.MEDIUM]:{damage:24}},F=[e.IDLE,e.WALK_BACKWARDS,e.WALK_FORWARDS,e.JUMP_LAND,e.JUMP_START,e.IDLE_TURN,e.LIGHT_KICK,e.LIGHT_PUNCH,e.MEDIUM_KICK,e.HURT_BODY_LIGHT,e.HURT_HEAD_LIGHT];function tt(s,t){return{id:s,playerId:t,healthPoints:T,rounds:0}}const G=230,Y=640,it=256,rt=Y/2,y=393,B=100;class St{constructor(t,i){r(this,"position");r(this,"fighters");this.position=t,this.fighters=i}update(t,i){this.position.y=-6+Math.floor(Math.min(this.fighters[1].position.y,this.fighters[0].position.y)/10);const h=Math.min(this.fighters[1].position.x,this.fighters[0].position.x),n=Math.max(this.fighters[1].position.x,this.fighters[0].position.x);if(n-h>t.canvas.width-B*2){const o=(n-h)/2;this.position.x=h+o-t.canvas.width/2}else for(const o of this.fighters)(o.position.x<this.position.x+B&&o.velocity.x*o.direction<0||o.position.x>this.position.x+t.canvas.width-B&&o.velocity.x*o.direction>0)&&(this.position.x+=o.velocity.x*o.direction*i.secondsPassed);this.position.x<y&&(this.position.x=y),this.position.x>Y+y-t.canvas.width&&(this.position.x=Y+y-t.canvas.width),this.position.y<0&&(this.position.y=0),this.position.y>it-t.canvas.height&&(this.position.y=it-t.canvas.height)}}var d=(s=>(s[s.FREEZE=0]="FREEZE",s[s.TRANSITION=-1]="TRANSITION",s))(d||{});function nt(s,t,i,h,n,o,l,m){return s<n+l&&s+i>n&&t<o+m&&t+h>o}function Rt(s,t){return nt(s.x,s.y,s.width,s.height,t.x,t.y,t.width,t.height)}function et(s,t,i){const h=s.x+i.x*t,n=h+i.width*t;return{x:Math.min(h,n),y:s.y+i.y,width:i.width,height:i.height}}class ot{constructor(t,i){r(this,"image",new Image);r(this,"name");r(this,"position");r(this,"velocity",{x:0,y:0});r(this,"gravity",1200);r(this,"initialVelocity",{x:{[e.WALK_FORWARDS]:100,[e.WALK_BACKWARDS]:-80,[e.JUMP_FORWARDS]:150,[e.JUMP_BACKWARDS]:-150},jump:-480});r(this,"frames");r(this,"animationFrame",0);r(this,"animationTimer",0);r(this,"currentState",e.IDLE);r(this,"states",{[e.IDLE]:{init:this.handleIdleInit.bind(this),update:this.handleIdleState.bind(this),validFrom:[void 0,e.IDLE,e.IDLE_TURN,e.JUMP_UP,e.JUMP_BACKWARDS,e.JUMP_FORWARDS,e.WALK_FORWARDS,e.WALK_BACKWARDS,e.CROUCH_UP,e.JUMP_LAND,e.JUMP_ROLL_LAND,e.LIGHT_PUNCH,e.LIGHT_KICK,e.MEDIUM_KICK,e.HURT_HEAD_LIGHT,e.HURT_BODY_LIGHT]},[e.IDLE_TURN]:{update:this.handleIdleTurnState.bind(this),validFrom:[e.IDLE,e.WALK_BACKWARDS,e.WALK_FORWARDS,e.JUMP_LAND,e.JUMP_ROLL_LAND]},[e.WALK_FORWARDS]:{init:this.handleMoveInit.bind(this),update:this.handleWalkForwardsState.bind(this),validFrom:[e.IDLE,e.WALK_BACKWARDS]},[e.WALK_BACKWARDS]:{init:this.handleMoveInit.bind(this),update:this.handleWalkBackwardsState.bind(this),validFrom:[e.IDLE,e.WALK_FORWARDS]},[e.JUMP_START]:{init:this.handleJumpStartInit.bind(this),update:this.handleJumpStartState.bind(this),validFrom:[e.IDLE,e.WALK_FORWARDS,e.WALK_BACKWARDS,e.JUMP_LAND,e.JUMP_ROLL_LAND]},[e.JUMP_UP]:{init:this.handleJumpInit.bind(this),update:this.handleJumpState.bind(this),validFrom:[e.JUMP_START]},[e.JUMP_FORWARDS]:{init:this.handleJumpInit.bind(this),update:this.handleJumpState.bind(this),validFrom:[e.JUMP_START]},[e.JUMP_BACKWARDS]:{init:this.handleJumpInit.bind(this),update:this.handleJumpState.bind(this),validFrom:[e.JUMP_START]},[e.JUMP_LAND]:{init:this.handleJumpLandInit.bind(this),update:this.handleJumpLandState.bind(this),validFrom:[e.JUMP_UP,e.JUMP_FORWARDS,e.JUMP_BACKWARDS]},[e.JUMP_ROLL_LAND]:{init:this.handleJumpLandInit.bind(this),update:this.handleJumpLandState.bind(this),validFrom:[e.JUMP_FORWARDS,e.JUMP_BACKWARDS]},[e.CROUCH]:{init:this.handleCrouchInit.bind(this),update:this.handleCrouchState.bind(this),validFrom:[e.CROUCH_DOWN]},[e.CROUCH_UP]:{update:this.handleCrouchUpState.bind(this),validFrom:[e.CROUCH]},[e.CROUCH_DOWN]:{init:this.handleCrouchDownInit.bind(this),update:this.handleCrouchDownState.bind(this),validFrom:[e.IDLE]},[e.CROUCH_TURN]:{update:this.handleCrouchTurnState.bind(this),validFrom:[e.CROUCH]},[e.LIGHT_PUNCH]:{attackType:O.PUNCH,attackStrength:S.LIGHT,init:this.handleStandartLightAttackInit.bind(this),update:this.handleLightPunchState.bind(this),validFrom:[e.IDLE,e.WALK_FORWARDS,e.WALK_BACKWARDS]},[e.LIGHT_KICK]:{attackType:O.KICK,attackStrength:S.LIGHT,init:this.handleStandartLightAttackInit.bind(this),update:this.handleLightKickState.bind(this),validFrom:[e.IDLE,e.WALK_FORWARDS,e.WALK_BACKWARDS]},[e.MEDIUM_KICK]:{attackType:O.KICK,attackStrength:S.LIGHT,init:this.handleStandartMediumAttackInit.bind(this),update:this.handleMediumKickState.bind(this),validFrom:[e.IDLE,e.WALK_FORWARDS,e.WALK_BACKWARDS]},[e.HURT_HEAD_LIGHT]:{init:this.handleHurtInit.bind(this),update:this.handleHurtState.bind(this),validFrom:F},[e.HURT_BODY_LIGHT]:{init:this.handleHurtInit.bind(this),update:this.handleHurtState.bind(this),validFrom:F},[e.WIN]:{init:this.handleFinishInit.bind(this),validFrom:F},[e.LOSE]:{init:this.handleFinishInit.bind(this),validFrom:F}});r(this,"animations",{idle:[],idleTurn:[],walkBackwards:[],walkForwards:[],crouch:[],crouchDown:[],crouchTurn:[],crouchUp:[],jumpBackwards:[],jumpForwards:[],jumpLand:[],jumpRollLand:[],jumpStart:[],jumpUp:[],lightKick:[],lightPunch:[],mediumKick:[],hurtHeadLight:[],hurtBodyLight:[],win:[],lose:[]});r(this,"direction");r(this,"playerId");r(this,"opponent");r(this,"boxes",{push:{x:0,y:0,width:0,height:0},hurt:{[g.HEAD]:[0,0,0,0],[g.BODY]:[0,0,0,0],[g.FEET]:[0,0,0,0]},hit:{x:0,y:0,width:0,height:0}});r(this,"attackStroke",!1);r(this,"onAttackHit");this.playerId=t,this.position={x:rt+y+(t===0?-Q:Q),y:G},this.direction=t===0?E.RIGHT:E.LEFT,this.onAttackHit=i}setAnimationFrame(t,i){const h=this.animations[this.currentState];this.animationFrame=t,this.animationFrame>=h.length&&(this.animationFrame=0);const[n,o]=h[this.animationFrame];this.boxes=this.getBoxes(n),this.animationTimer=i.previous+o*$}changeState(t,i){if(!this.states[t].validFrom.includes(this.currentState))return;this.currentState=t,this.setAnimationFrame(0,i);const h=this.states[t];h.init&&h.init()}handleIdleInit(){this.resetVelocities(),this.attackStroke=!1}handleCrouchInit(){this.resetVelocities()}handleCrouchDownInit(){this.resetVelocities()}handleJumpStartInit(){this.resetVelocities()}handleJumpInit(){let t=this.initialVelocity.jump;(this.currentState===e.JUMP_FORWARDS||this.currentState===e.JUMP_BACKWARDS)&&(t-=80),this.velocity.y=t,this.handleMoveInit()}handleMoveInit(){this.velocity.x=this.initialVelocity.x[this.currentState]??0}handleJumpLandInit(){this.resetVelocities()}handleStandartLightAttackInit(){this.resetVelocities()}handleStandartMediumAttackInit(){this.resetVelocities()}handleHurtInit(){this.resetVelocities()}handleFinishInit(){this.resetVelocities()}handleIdleState(t){H(this.playerId)?this.changeState(e.JUMP_START,t):q(this.playerId)?this.changeState(e.CROUCH_DOWN,t):W(this.playerId,this.direction)?this.changeState(e.WALK_FORWARDS,t):J(this.playerId,this.direction)?this.changeState(e.WALK_BACKWARDS,t):C(this.playerId)?this.changeState(e.LIGHT_PUNCH,t):P(this.playerId)?this.changeState(e.LIGHT_KICK,t):j(this.playerId)&&this.changeState(e.MEDIUM_KICK,t);const i=this.getDirection();i!==this.direction&&(this.direction=i,this.changeState(e.IDLE_TURN,t))}handleIdleTurnState(t){this.handleIdleState(t),this.isAnimationCompleted()&&this.changeState(e.IDLE,t)}handleWalkForwardsState(t){W(this.playerId,this.direction)?H(this.playerId)?this.changeState(e.JUMP_START,t):C(this.playerId)?this.changeState(e.LIGHT_PUNCH,t):P(this.playerId)?this.changeState(e.LIGHT_KICK,t):j(this.playerId)&&this.changeState(e.MEDIUM_KICK,t):this.changeState(e.IDLE,t),this.direction=this.getDirection()}handleWalkBackwardsState(t){J(this.playerId,this.direction)?H(this.playerId)?this.changeState(e.JUMP_START,t):C(this.playerId)?this.changeState(e.LIGHT_PUNCH,t):P(this.playerId)?this.changeState(e.LIGHT_KICK,t):j(this.playerId)&&this.changeState(e.MEDIUM_KICK,t):this.changeState(e.IDLE,t),this.direction=this.getDirection()}handleJumpStartState(t){this.isAnimationCompleted()&&(J(this.playerId,this.direction)?this.changeState(e.JUMP_BACKWARDS,t):W(this.playerId,this.direction)?this.changeState(e.JUMP_FORWARDS,t):this.changeState(e.JUMP_UP,t))}handleJumpState(t){this.velocity.y+=this.gravity*t.secondsPassed,this.position.y>G&&(this.position.y=G,this.currentState===e.JUMP_FORWARDS||this.currentState===e.JUMP_BACKWARDS?this.changeState(e.JUMP_ROLL_LAND,t):this.changeState(e.JUMP_LAND,t))}handleJumpLandState(t){if(this.animationFrame<1)return;let i=e.IDLE;if(!wt(this.playerId))this.direction=this.getDirection(),this.handleIdleState(t);else{const h=this.getDirection();if(h!==this.direction)this.direction=h,i=e.IDLE_TURN;else if(!this.isAnimationCompleted())return}this.changeState(i,t)}handleCrouchState(t){q(this.playerId)||this.changeState(e.CROUCH_UP,t);const i=this.getDirection();i!==this.direction&&(this.direction=i,this.changeState(e.IDLE_TURN,t))}handleCrouchUpState(t){this.isAnimationCompleted()&&this.changeState(e.IDLE,t)}handleCrouchDownState(t){this.isAnimationCompleted()&&this.changeState(e.CROUCH,t)}handleCrouchTurnState(t){this.handleCrouchState(t),this.isAnimationCompleted()&&this.changeState(e.CROUCH,t)}handleLightAttackReset(t){this.setAnimationFrame(0,t),this.resetVelocities(),this.attackStroke=!1}handleLightPunchState(t){const i=this.animations[e.LIGHT_PUNCH].length-1;this.animationFrame<i||(C(this.playerId)&&this.handleLightAttackReset(t),this.isAnimationCompleted()&&this.changeState(e.IDLE,t))}handleLightKickState(t){const i=this.animations[e.LIGHT_KICK].length-1;this.animationFrame<i||(P(this.playerId)&&this.handleLightAttackReset(t),this.isAnimationCompleted()&&this.changeState(e.IDLE,t))}handleMediumKickState(t){this.isAnimationCompleted()&&this.changeState(e.IDLE,t)}handleHurtState(t){this.isAnimationCompleted()&&this.changeState(e.IDLE,t)}handleAttackHit(t,i,h){const n=this.getHitState(t,i);this.changeState(n,h)}hasCollideWithOpponent(){return nt(this.position.x+this.boxes.push.x,this.position.y+this.boxes.push.y,this.boxes.push.width,this.boxes.push.height,this.opponent.position.x+this.opponent.boxes.push.x,this.opponent.position.y+this.opponent.boxes.push.y,this.opponent.boxes.push.width,this.opponent.boxes.push.height)}isAnimationCompleted(){return this.animations[this.currentState][this.animationFrame][1]===d.TRANSITION}resetVelocities(){this.velocity={x:0,y:0}}getDirection(){return this.position.x+this.boxes.push.x+this.boxes.push.width<=this.opponent.position.x+this.opponent.boxes.push.x?E.RIGHT:this.position.x+this.boxes.push.x>=this.opponent.position.x+this.opponent.boxes.push.x+this.opponent.boxes.push.width?E.LEFT:this.direction}getBoxes(t){const[,,[i=0,h=0,n=0,o=0]=[],[l=[0,0,0,0],m=[0,0,0,0],p=[0,0,0,0]]=[],[w=0,L=0,M=0,lt=0]=[]]=this.frames.get(t);return{push:{x:i,y:h,width:n,height:o},hurt:{[g.HEAD]:l,[g.BODY]:m,[g.FEET]:p},hit:{x:w,y:L,width:M,height:lt}}}getHitState(t,i){switch(t){case S.LIGHT:return i===g.HEAD?e.HURT_HEAD_LIGHT:e.HURT_BODY_LIGHT}}updateStageContraints(t,i,h){this.position.x>h.position.x+t.canvas.width-this.boxes.push.width&&(this.position.x=h.position.x+t.canvas.width-this.boxes.push.width),this.position.x<h.position.x+this.boxes.push.width&&(this.position.x=h.position.x+this.boxes.push.width),this.hasCollideWithOpponent()&&(this.position.x<=this.opponent.position.x&&(this.position.x=Math.max(this.opponent.position.x+this.opponent.boxes.push.x-(this.boxes.push.x+this.boxes.push.width),h.position.x+this.boxes.push.width),[e.IDLE,e.CROUCH,e.JUMP_UP,e.JUMP_FORWARDS,e.JUMP_BACKWARDS].includes(this.opponent.currentState)&&(this.opponent.position.x+=z*i.secondsPassed)),this.position.x>=this.opponent.position.x&&(this.position.x=Math.min(this.opponent.position.x+this.opponent.boxes.push.x+this.opponent.boxes.push.width+(this.boxes.push.x+this.boxes.push.width),h.position.x+t.canvas.width-this.boxes.push.width),[e.IDLE,e.CROUCH,e.JUMP_UP,e.JUMP_FORWARDS,e.JUMP_BACKWARDS].includes(this.opponent.currentState)&&(this.opponent.position.x-=z*i.secondsPassed)))}updateAttackBoxCollided(t){if(!this.states[this.currentState].attackType||this.attackStroke)return;const i=et(this.position,this.direction,this.boxes.hit);for(const[h,n]of Object.entries(this.opponent.boxes.hurt)){const[o,l,m,p]=n,w=et(this.opponent.position,this.opponent.direction,{x:o,y:l,width:m,height:p});if(!Rt(i,w))continue;const L=this.states[this.currentState].attackStrength;this.onAttackHit(this.playerId,this.opponent.playerId,L),this.opponent.handleAttackHit(L,h,t),this.attackStroke=!0;return}}updateAnimation(t){this.animations[this.currentState][this.animationFrame][1]<=d.FREEZE||t.previous<=this.animationTimer||this.setAnimationFrame(this.animationFrame+1,t)}update(t,i,h){this.position.x+=this.velocity.x*this.direction*i.secondsPassed,this.position.y+=this.velocity.y*i.secondsPassed;const n=this.states[this.currentState];n.update&&n.update(i),this.updateAnimation(i),this.updateStageContraints(t,i,h),this.updateAttackBoxCollided(i)}draw(t,i){const[h]=this.animations[this.currentState][this.animationFrame],[[n,o,l,m],[p,w]]=this.frames.get(h);t.scale(this.direction,1),t.drawImage(this.image,n,o,l,m,Math.floor((this.position.x-i.position.x)*this.direction)-p,Math.floor(this.position.y-i.position.y)-w,l,m),t.setTransform(1,0,0,1,0,0)}drawDebugBox(t,i,h,n){if(!Array.isArray(h))return;const[o=0,l=0,m=0,p=0]=h;t.beginPath(),t.strokeStyle=n+"AA",t.fillStyle=n+"44",t.fillRect(Math.floor(this.position.x+o*this.direction-i.position.x)+.5,Math.floor(this.position.y+l-i.position.y)+.5,m*this.direction,p),t.rect(Math.floor(this.position.x+o*this.direction-i.position.x)+.5,Math.floor(this.position.y+l-i.position.y)+.5,m*this.direction,p),t.stroke()}drawDebug(t,i){const[h]=this.animations[this.currentState][this.animationFrame],n=this.getBoxes(h),{push:o,hurt:l,hit:m}=n;t.lineWidth=1,this.drawDebugBox(t,i,Object.values(o),"#55FF55");for(const p of Object.values(l))this.drawDebugBox(t,i,p,"#7777FF");this.drawDebugBox(t,i,Object.values(m),"#FF0000"),t.beginPath(),t.strokeStyle="white",t.moveTo(Math.floor(this.position.x-i.position.x-4),Math.floor(this.position.y-i.position.y)-.5),t.lineTo(Math.floor(this.position.x-i.position.x+5),Math.floor(this.position.y-i.position.y)-.5),t.moveTo(Math.floor(this.position.x-i.position.x)+.5,Math.floor(this.position.y-i.position.y)-5),t.lineTo(Math.floor(this.position.x-i.position.x)+.5,Math.floor(this.position.y-i.position.y)+4),t.stroke()}}class Tt extends ot{constructor(t,i){super(t,i);const h=document.querySelector('img[alt="liu-kang"]');this.image=h,this.name=I["LIU-KANG"],this.frames=new Map([["forwards-1",[[74,148,37,101],[14,98],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["forwards-2",[[120,148,34,101],[12,98],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["forwards-3",[[164,150,33,99],[11,96],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["forwards-4",[[206,153,35,96],[12,93],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["forwards-5",[[250,151,37,98],[14,96],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["forwards-6",[[296,150,34,99],[12,96],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["forwards-7",[[340,149,34,100],[12,97],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["forwards-8",[[385,152,39,97],[14,94],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-1",[[92,23,47,94],[23,91],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-2",[[149,22,47,95],[23,92],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-3",[[206,18,47,99],[23,96],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-4",[[263,21,47,96],[23,93],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-5",[[321,24,47,93],[23,90],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-6",[[378,21,47,96],[23,93],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-7",[[435,18,47,99],[23,96],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-8",[[492,22,47,95],[23,92],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-turn-1",[[569,20,51,97],[26,94],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-turn-2",[[630,20,50,97],[25,94],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["idle-turn-3",[[691,20,51,97],[26,94],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["jump-start-1",[[647,156,47,93],[23,90],a.IDLE,[[-7,-95,16,20],[-12,-75,25,37],[-20,-37,40,38]]]],["jump-up-1",[[471,174,48,75],[24,71],a.JUMP_UP,[[-7,-74,16,20],[-12,-54,25,25],[-20,-29,40,30]]]],["jump-land-1",[[587,161,49,88],[25,86],a.IDLE,[[-7,-87,16,20],[-12,-67,25,35],[-20,-32,40,30]]]],["jump-land-2",[[647,156,47,93],[23,90],a.IDLE,[[-7,-92,16,20],[-12,-72,25,35],[-20,-37,40,35]]]],["jump-roll-land-1",[[732,176,35,73],[17,70],a.JUMP_UP,[[0,-69,16,20],[-12,-55,25,35],[-15,-37,30,35]]]],["jump-forwards-1",[[777,198,29,51],[14,48],a.JUMP,[[0,-50,16,20],[-12,-45,25,30],[0,-25,10,30]]]],["jump-forwards-2",[[816,202,38,47],[19,44],a.JUMP,[[3,-44,16,20],[-12,-45,25,30],[-15,-25,10,30]]]],["jump-forwards-3",[[865,216,45,33],[22,30],a.JUMP,[[5,-15,16,20],[-12,-30,25,30],[-15,-25,10,30]]]],["jump-forwards-4",[[920,206,40,43],[20,40],a.JUMP,[[-5,-15,16,20],[-5,-40,25,30],[-15,-35,10,30]]]],["jump-forwards-5",[[972,198,30,51],[15,48],a.JUMP,[[-15,-15,16,20],[-5,-40,25,30],[-15,-35,10,30]]]],["jump-forwards-6",[[1013,202,37,47],[18,44],a.JUMP,[[-15,-15,16,20],[-15,-30,30,30],[5,-45,10,30]]]],["jump-forwards-7",[[1059,216,45,33],[22,30],a.JUMP,[[-20,-30,16,20],[-15,-20,30,20],[-10,-25,30,10]]]],["jump-forwards-8",[[1115,204,41,45],[20,42],a.JUMP,[[-15,-41,16,20],[-20,-25,30,20],[0,-25,10,30]]]],["crouch-1",[[988,27,47,90],[23,87],a.IDLE,[[-7,-87,16,20],[-12,-67,25,35],[-20,-32,40,30]]]],["crouch-2",[[1045,49,49,68],[23,65],a.IDLE,[[-3,-64,16,20],[-12,-50,25,25],[-20,-25,40,25]]]],["crouch-3",[[1104,60,48,59],[24,56],a.CROUCH,[[-3,-55,16,20],[-12,-50,25,25],[-20,-25,40,25]]]],["light-punch-1",[[18,390,47,102],[23,99],a.PUNCH,[[2,-101,19,18],[-15,-84,40,45],[-15,-38,40,40]]]],["light-punch-2",[[75,388,53,104],[23,101],a.PUNCH,[[5,-101,19,18],[-5,-84,30,45],[-15,-38,40,40]]]],["light-punch-3",[[140,393,74,99],[23,96],a.PUNCH,[[13,-101,19,18],[0,-84,30,45],[-15,-38,40,40]],[25,-90,28,13]]],["light-kick-1",[[340,504,44,100],[23,97],a.IDLE,[[-10,-96,19,18],[-10,-85,23,45],[-15,-40,30,40]]]],["light-kick-2",[[395,503,39,101],[23,98],a.IDLE,[[-20,-96,19,18],[-20,-85,23,45],[-20,-40,30,40]]]],["light-kick-3",[[444,504,37,100],[23,97],a.IDLE,[[-20,-96,19,18],[-15,-85,23,45],[-10,-40,30,40]]]],["light-kick-4",[[492,507,45,97],[23,94],a.IDLE,[[-20,-96,19,18],[-15,-85,23,45],[-10,-40,15,40]]]],["light-kick-5",[[545,506,69,98],[23,95],a.IDLE,[[-20,-96,19,18],[-15,-85,23,45],[-10,-40,15,40]],[23,-84,28,13]]],["medium-kick-1",[[19,615,61,99],[23,96],a.IDLE,[[0,-95,16,20],[0,-75,20,37],[0,-37,30,38]]]],["medium-kick-2",[[91,617,49,97],[23,94],a.IDLE,[[0,-95,16,20],[0,-75,20,37],[0,-37,30,38]]]],["medium-kick-3",[[149,625,37,90],[23,87],a.IDLE,[[-25,-86,16,10],[-20,-75,30,37],[-10,-37,15,38]]]],["medium-kick-4",[[196,615,57,99],[23,96],a.IDLE,[[],[-20,-75,30,37],[-10,-37,15,38]],[15,-99,30,13]]],["medium-kick-5",[[262,637,35,78],[23,75],a.JUMP_UP,[[0,-75,16,10],[-20,-75,30,37],[-10,-37,20,38]]]],["medium-kick-6",[[308,619,44,96],[23,93],a.IDLE,[[0,-92,16,16],[-10,-75,25,40],[-10,-37,30,38]]]],["medium-kick-7",[[363,614,44,101],[23,98],a.IDLE,[[-10,-97,16,16],[-10,-81,25,45],[-10,-37,30,38]]]],["hurt-head-light-1",[[18,860,43,102],[21,99],a.IDLE,[[-12,-99,17,20],[-15,-78,26,48],[-20,-30,40,30]]]],["hurt-head-light-2",[[71,862,44,102],[22,99],a.IDLE,[[-12,-99,17,20],[-15,-78,26,48],[-20,-30,40,30]]]],["hurt-head-light-3",[[125,870,43,94],[21,91],a.IDLE,[[-20,-92,17,10],[-15,-82,26,52],[-20,-30,40,30]]]],["hurt-body-light-1",[[217,865,46,99],[23,96],a.IDLE,[[-7,-95,17,15],[-15,-80,26,52],[-20,-28,40,30]]]],["hurt-body-light-2",[[273,866,49,98],[25,95],a.IDLE,[[-13,-95,17,15],[-13,-80,26,52],[-13,-30,40,30]]]],["hurt-body-light-3",[[333,868,50,96],[18,97],a.IDLE,[[-11,-95,17,15],[-7,-80,26,52],[-10,-30,40,30]]]],["win-1",[[1203,147,37,102],[18,99],a.IDLE,[]]],["win-2",[[1250,147,74,103],[37,100],a.IDLE,[]]],["win-3",[[1332,150,54,99],[27,96],a.IDLE,[]]],["win-4",[[1396,150,34,99],[17,96],a.IDLE,[]]],["win-5",[[1441,151,34,98],[17,95],a.IDLE,[]]],["win-6",[[1485,147,36,102],[18,99],a.IDLE,[]]],["win-7",[[1532,147,74,101],[37,98],a.IDLE,[]]],["win-8",[[1616,141,71,108],[35,105],a.IDLE,[]]],["win-9",[[1695,128,34,121],[17,118],a.IDLE,[]]],["win-10",[[1740,133,34,116],[17,113],a.IDLE,[]]],["win-11",[[1785,144,34,105],[17,102],a.IDLE,[]]],["win-12",[[1832,148,34,101],[17,98],a.IDLE,[]]],["win-13",[[1877,153,34,96],[17,93],a.IDLE,[]]],["lose-1",[[18,972,70,107],[35,104],a.IDLE,[]]],["lose-2",[[99,987,74,92],[37,89],a.IDLE,[]]],["lose-3",[[183,1018,62,61],[31,58],a.IDLE,[]]],["lose-4",[[255,1021,50,58],[25,55],a.IDLE,[]]],["lose-5",[[316,1009,53,70],[26,67],a.IDLE,[]]],["lose-6",[[379,1017,46,62],[23,59],a.IDLE,[]]],["lose-7",[[437,1035,71,44],[35,41],a.IDLE,[]]],["lose-8",[[519,1051,79,28],[39,25],a.IDLE,[]]]]),this.animations[e.IDLE]=[["idle-1",6],["idle-2",6],["idle-3",6],["idle-4",6],["idle-5",6],["idle-6",6],["idle-7",6],["idle-8",6]],this.animations[e.IDLE_TURN]=[["idle-turn-3",4],["idle-turn-2",4],["idle-turn-1",4],["idle-turn-1",d.TRANSITION]],this.animations[e.WALK_FORWARDS]=[["forwards-1",4],["forwards-2",4],["forwards-3",4],["forwards-4",4],["forwards-5",4],["forwards-6",4],["forwards-7",4],["forwards-8",4]],this.animations[e.WALK_BACKWARDS]=[["forwards-8",4],["forwards-7",4],["forwards-6",4],["forwards-5",4],["forwards-4",4],["forwards-3",4],["forwards-2",4],["forwards-1",4]],this.animations[e.JUMP_START]=[["jump-start-1",5],["jump-start-1",d.TRANSITION]],this.animations[e.JUMP_UP]=[["jump-up-1",5],["jump-up-1",d.FREEZE]],this.animations[e.JUMP_LAND]=[["jump-land-1",5],["jump-land-2",5],["jump-land-2",d.TRANSITION]],this.animations[e.JUMP_ROLL_LAND]=[["jump-roll-land-1",5],["jump-roll-land-1",d.TRANSITION]],this.animations[e.JUMP_FORWARDS]=[["jump-forwards-1",4],["jump-forwards-2",4],["jump-forwards-3",4],["jump-forwards-4",4],["jump-forwards-5",4],["jump-forwards-6",4],["jump-forwards-7",4],["jump-forwards-8",4]],this.animations[e.JUMP_BACKWARDS]=[["jump-forwards-8",4],["jump-forwards-7",4],["jump-forwards-6",4],["jump-forwards-5",4],["jump-forwards-4",4],["jump-forwards-3",4],["jump-forwards-2",4],["jump-forwards-1",4]],this.animations[e.CROUCH]=[["crouch-3",d.FREEZE]],this.animations[e.CROUCH_DOWN]=[["crouch-1",2],["crouch-2",2],["crouch-3",2],["crouch-3",d.TRANSITION]],this.animations[e.CROUCH_UP]=[["crouch-3",2],["crouch-2",2],["crouch-1",2],["crouch-1",d.TRANSITION]],this.animations[e.CROUCH_TURN]=[["crouch-3",d.FREEZE]],this.animations[e.LIGHT_PUNCH]=[["light-punch-1",5],["light-punch-2",7],["light-punch-3",9],["light-punch-2",6],["light-punch-2",d.TRANSITION]],this.animations[e.LIGHT_KICK]=[["light-kick-1",4],["light-kick-2",4],["light-kick-3",7],["light-kick-4",7],["light-kick-5",7],["light-kick-4",5],["light-kick-3",4],["light-kick-2",4],["light-kick-2",d.TRANSITION]],this.animations[e.MEDIUM_KICK]=[["medium-kick-1",5],["medium-kick-2",5],["medium-kick-3",7],["medium-kick-4",7],["medium-kick-5",7],["medium-kick-6",7],["medium-kick-7",7],["medium-kick-7",d.TRANSITION]],this.animations[e.HURT_HEAD_LIGHT]=[["hurt-head-light-1",6],["hurt-head-light-2",6],["hurt-head-light-3",6],["hurt-head-light-3",d.TRANSITION]],this.animations[e.HURT_BODY_LIGHT]=[["hurt-body-light-1",6],["hurt-body-light-2",6],["hurt-body-light-3",6],["hurt-body-light-3",d.TRANSITION]],this.animations[e.WIN]=[["win-1",6],["win-2",6],["win-3",6],["win-4",6],["win-5",6],["win-6",6],["win-7",6],["win-8",6],["win-9",6],["win-10",6],["win-11",6],["win-12",6],["win-13",6],["win-13",d.TRANSITION]],this.animations[e.LOSE]=[["lose-1",6],["lose-2",6],["lose-3",6],["lose-4",6],["lose-5",6],["lose-6",6],["lose-7",6],["lose-8",6],["lose-8",d.TRANSITION]]}draw(t,i){super.draw(t,i)}}class At extends ot{constructor(t,i){super(t,i);const h=document.querySelector('img[alt="raiden"]');this.image=h,this.name=I.RAIDEN,this.frames=new Map([["forwards-1",[[782,141,46,101],[23,98],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["forwards-2",[[838,144,40,102],[20,99],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["forwards-3",[[888,143,40,103],[20,100],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["forwards-4",[[940,144,40,102],[20,99],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["forwards-5",[[993,145,40,101],[20,98],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["forwards-6",[[1043,143,46,103],[23,100],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["forwards-7",[[1100,142,40,104],[20,101],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["forwards-8",[[1150,142,40,104],[20,101],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["forwards-9",[[1201,145,40,101],[20,98],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-1",[[103,21,46,102],[23,99],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-2",[[162,21,46,102],[23,99],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-3",[[221,21,46,102],[23,99],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-4",[[279,21,46,102],[23,99],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-5",[[338,21,46,102],[23,99],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-6",[[456,21,46,102],[23,99],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-7",[[577,21,46,102],[23,99],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-8",[[635,21,46,102],[23,99],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-turn-1",[[20,143,47,103],[24,100],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-turn-2",[[78,142,47,104],[24,101],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["idle-turn-3",[[136,143,47,103],[24,100],a.IDLE,[[-13,-95,19,18],[-21,-77,40,38],[-21,-38,40,40]]]],["jump-start-1",[[1405,157,51,89],[25,86],a.IDLE,[[-9,-88,19,18],[-20,-70,40,39],[-20,-30,40,30]]]],["jump-up-1",[[1290,162,44,84],[22,81],a.JUMP_UP,[[-9,-83,19,18],[-21,-64,40,39],[-21,-25,40,25]]]],["jump-land-1",[[1405,157,51,89],[25,86],a.IDLE,[[-9,-85,19,18],[-21,-67,40,39],[-21,-28,40,30]]]],["jump-roll-land-1",[[1501,155,42,91],[21,88],a.IDLE,[[-8,-90,19,18],[-21,-72,40,30],[-21,-41,40,40]]]],["jump-forwards-1",[[1552,191,36,55],[13,52],a.JUMP,[[9,-54,19,18],[-10,-50,21,35],[5,-35,14,32]]]],["jump-forwards-2",[[1598,196,43,50],[21,47],a.JUMP,[[5,-40,19,18],[-19,-50,35,35],[-8,-35,14,32]]]],["jump-forwards-3",[[1650,204,48,42],[24,39],a.JUMP,[[9,-15,19,18],[-10,-40,21,35],[-20,-35,14,32]]]],["jump-forwards-4",[[1710,195,44,51],[22,48],a.JUMP,[[-5,-15,19,18],[0,-50,21,35],[-10,-45,14,32]]]],["jump-forwards-5",[[1765,192,36,54],[13,51],a.JUMP,[[-15,-15,19,18],[-10,-50,21,35],[5,-35,14,32]]]],["jump-forwards-6",[[1812,196,42,50],[21,47],a.JUMP,[[-25,-25,19,18],[-10,-30,25,35],[-10,-35,14,32]]]],["jump-forwards-7",[[1866,204,47,42],[23,39],a.JUMP,[[-25,-40,19,18],[-20,-40,21,35],[2,-35,14,32]]]],["crouch-1",[[441,157,45,89],[22,86],a.IDLE,[[-10,-88,20,16],[-20,-72,41,41],[-20,-31,40,32]]]],["crouch-2",[[500,157,47,89],[23,86],a.JUMP_UP,[[-10,-73,20,16],[-16,-56,32,30],[-21,-25,42,25]]]],["crouch-3",[[557,187,48,59],[24,56],a.CROUCH,[[-10,-58,20,16],[-16,-41,32,16],[-21,-25,40,25]]]],["light-punch-1",[[20,394,49,103],[23,100],a.PUNCH,[[2,-101,19,18],[-15,-84,40,45],[-15,-38,40,40]]]],["light-punch-2",[[79,396,50,101],[23,99],a.PUNCH,[[5,-101,19,18],[-5,-84,30,45],[-15,-38,40,40]]]],["light-punch-3",[[139,398,76,99],[23,96],a.PUNCH,[[13,-101,19,18],[0,-84,30,45],[-15,-38,40,40]],[25,-96,28,13]]],["light-kick-1",[[311,512,50,104],[23,101],a.IDLE,[[-5,-103,19,18],[-15,-85,40,45],[-15,-40,40,40]]]],["light-kick-2",[[372,509,40,107],[23,104],a.IDLE,[[-20,-106,19,18],[-20,-87,30,45],[-15,-41,30,40]]]],["light-kick-3",[[422,527,59,89],[23,86],a.IDLE,[[-25,-88,19,18],[-15,-85,30,45],[-15,-41,30,40]]]],["light-kick-4",[[494,526,80,90],[23,87],a.IDLE,[[-25,-88,19,18],[-15,-85,30,45],[-15,-41,30,40]],[23,-84,35,13]]],["medium-kick-1",[[609,513,40,102],[23,99],a.IDLE,[[-22,-99,20,16],[-25,-83,41,41],[-20,-42,40,43]]]],["medium-kick-2",[[660,514,49,102],[23,99],a.IDLE,[[-22,-99,20,16],[-25,-83,41,41],[-20,-42,40,43]]]],["medium-kick-3",[[740,535,45,81],[23,78],a.JUMP_UP,[[-22,-77,20,16],[-20,-77,41,40],[-20,-37,40,33]]]],["medium-kick-4",[[796,535,51,81],[23,78],a.JUMP_UP,[[-22,-77,10,16],[-20,-77,41,40],[-20,-37,40,33]]]],["medium-kick-5",[[857,511,69,105],[23,102],a.IDLE,[[-22,-70,10,16],[-20,-77,41,40],[-20,-37,40,33]],[23,-102,28,13]]],["medium-kick-6",[[937,536,51,80],[23,77],a.JUMP_UP,[[-22,-77,20,16],[-20,-77,41,40],[-20,-37,40,33]]]],["medium-kick-7",[[998,523,37,93],[23,90],a.IDLE,[[-22,-94,20,16],[-20,-77,41,40],[-20,-37,40,33]]]],["medium-kick-8",[[1046,509,46,107],[23,104],a.IDLE,[[-10,-106,20,16],[-20,-90,41,50],[-20,-40,40,36]]]],["hurt-head-light-1",[[79,761,51,99],[25,96],a.IDLE,[[-23,-96,17,19],[-23,-77,34,40],[-20,-37,40,40]]]],["hurt-head-light-2",[[142,765,54,95],[27,92],a.IDLE,[[-30,-96,17,19],[-23,-77,34,40],[-20,-37,40,40]]]],["hurt-head-light-3",[[208,766,59,94],[29,91],a.IDLE,[[-30,-96,17,19],[-23,-77,34,40],[-20,-37,40,40]]]],["hurt-body-light-1",[[312,762,48,98],[24,95],a.IDLE,[[-20,-92,17,10],[-15,-82,26,52],[-20,-30,40,30]]]],["hurt-body-light-2",[[371,763,51,97],[25,94],a.IDLE,[[-25,-92,17,15],[-25,-76,30,43],[-20,-33,40,30]]]],["hurt-body-light-3",[[432,767,56,93],[28,90],a.IDLE,[[-25,-92,17,15],[-25,-76,30,43],[-20,-33,40,30]]]],["win-1",[[20,284,48,97],[24,94],a.IDLE,[]]],["win-2",[[80,287,49,94],[24,91],a.IDLE,[]]],["win-3",[[139,286,70,95],[35,92],a.IDLE,[]]],["win-4",[[220,282,82,99],[41,96],a.IDLE,[]]],["win-5",[[313,259,48,122],[24,119],a.IDLE,[]]],["lose-1",[[20,885,63,91],[31,88],a.IDLE,[]]],["lose-2",[[93,911,72,65],[36,62],a.IDLE,[]]],["lose-3",[[176,928,72,48],[36,45],a.IDLE,[]]],["lose-4",[[259,914,70,62],[35,59],a.IDLE,[]]],["lose-5",[[340,920,78,56],[44,53],a.IDLE,[]]],["lose-6",[[429,950,85,26],[42,23],a.IDLE,[]]]]),this.animations[e.IDLE]=[["idle-1",7],["idle-2",7],["idle-3",7],["idle-4",7],["idle-5",7],["idle-6",7],["idle-7",7],["idle-8",7]],this.animations[e.IDLE_TURN]=[["idle-turn-3",4],["idle-turn-2",4],["idle-turn-1",4],["idle-turn-1",d.TRANSITION]],this.animations[e.WALK_FORWARDS]=[["forwards-1",4],["forwards-2",4],["forwards-3",4],["forwards-4",4],["forwards-5",4],["forwards-6",4],["forwards-7",4],["forwards-8",4],["forwards-9",4]],this.animations[e.WALK_BACKWARDS]=[["forwards-9",4],["forwards-8",4],["forwards-7",4],["forwards-6",4],["forwards-5",4],["forwards-4",4],["forwards-3",4],["forwards-2",4],["forwards-1",4]],this.animations[e.JUMP_START]=[["jump-start-1",5],["jump-start-1",d.TRANSITION]],this.animations[e.JUMP_UP]=[["jump-up-1",5],["jump-up-1",d.FREEZE]],this.animations[e.JUMP_LAND]=[["jump-land-1",5],["jump-land-1",d.TRANSITION]],this.animations[e.JUMP_ROLL_LAND]=[["jump-roll-land-1",5],["jump-roll-land-1",d.TRANSITION]],this.animations[e.JUMP_FORWARDS]=[["jump-forwards-1",4],["jump-forwards-2",4],["jump-forwards-3",4],["jump-forwards-4",4],["jump-forwards-5",4],["jump-forwards-6",4],["jump-forwards-7",4]],this.animations[e.JUMP_BACKWARDS]=[["jump-forwards-7",4],["jump-forwards-6",4],["jump-forwards-5",4],["jump-forwards-4",4],["jump-forwards-3",4],["jump-forwards-2",4],["jump-forwards-1",4]],this.animations[e.CROUCH]=[["crouch-3",d.FREEZE]],this.animations[e.CROUCH_DOWN]=[["crouch-1",2],["crouch-2",2],["crouch-3",2],["crouch-3",d.TRANSITION]],this.animations[e.CROUCH_UP]=[["crouch-3",2],["crouch-2",2],["crouch-1",2],["crouch-1",d.TRANSITION]],this.animations[e.CROUCH_TURN]=[["crouch-3",d.FREEZE]],this.animations[e.LIGHT_PUNCH]=[["light-punch-1",5],["light-punch-2",7],["light-punch-3",9],["light-punch-2",6],["light-punch-2",d.TRANSITION]],this.animations[e.LIGHT_KICK]=[["light-kick-1",5],["light-kick-2",7],["light-kick-3",7],["light-kick-4",7],["light-kick-3",7],["light-kick-2",7],["light-kick-2",d.TRANSITION]],this.animations[e.MEDIUM_KICK]=[["medium-kick-1",5],["medium-kick-2",5],["medium-kick-3",5],["medium-kick-4",7],["medium-kick-5",7],["medium-kick-6",7],["medium-kick-7",5],["medium-kick-8",5],["medium-kick-8",d.TRANSITION]],this.animations[e.HURT_HEAD_LIGHT]=[["hurt-head-light-1",4],["hurt-head-light-2",4],["hurt-head-light-3",4],["hurt-head-light-3",d.TRANSITION]],this.animations[e.HURT_BODY_LIGHT]=[["hurt-body-light-1",4],["hurt-body-light-2",4],["hurt-body-light-3",4],["hurt-body-light-3",d.TRANSITION]],this.animations[e.WIN]=[["win-1",6],["win-2",6],["win-3",6],["win-4",6],["win-5",6],["win-5",d.TRANSITION]],this.animations[e.LOSE]=[["lose-1",6],["lose-2",6],["lose-3",6],["lose-4",6],["lose-5",6],["lose-6",6],["lose-6",d.TRANSITION]]}draw(t,i){super.draw(t,i)}}class st{constructor(){r(this,"image",document.querySelector('img[alt="misc"]'));r(this,"frames",new Map([["round-1",[5184,53,77,19]],["round-2",[5183,138,79,18]],["round-3",[5184,222,78,18]]]));r(this,"raiden",new A(this.image,[["raiden-1",[3816,125,118,19]],["raiden-2",[4147,125,118,19]]],[["raiden-1",6],["raiden-2",6]]));r(this,"liuKang",new A(this.image,[["liu-kang-1",[3807,178,140,18]],["liu-kang-2",[4138,178,139,18]]],[["liu-kang-1",6],["liu-kang-2",6]]));r(this,"fight",new A(this.image,[["fight-1",[2772,53,67,16]],["fight-2",[2761,123,87,21]],["fight-3",[2748,191,114,28]],["fight-4",[2730,258,151,37]]],[["fight-1",6],["fight-2",6],["fight-3",6],["fight-4",10],["fight-4",d.TRANSITION]]));r(this,"drawControl",{round:!1,fight:!1});r(this,"timer",0)}updateRound(t){this.drawControl.round||(this.timer===0&&(this.timer=t.previous+500),t.previous>this.timer&&(this.drawControl.round=!0,this.timer=0))}updateFight(t){if(!this.drawControl.round||this.drawControl.fight)return;const[,i]=this.fight.animation[this.fight.animationFrame];if(i===d.TRANSITION){this.drawControl.fight=!0;return}this.fight.update(t)}updateEndRound(t){const i=u.fighters.filter(h=>h.healthPoints===0)[0];(!this.drawControl.round||this.drawControl.fight)&&!i||this.raiden.update(t)}update(t,i){this.updateRound(i),this.updateFight(i),this.updateWinner(i)}drawFrame(t,i,h,n,o,l){U(t,this.image,this.frames.get(i),h,n,o,l)}drawFight(t){if(!this.drawControl.round||this.drawControl.fight)return;const[i]=this.fight.animation[this.fight.animationFrame],[,,h,n]=this.fight.frames.get(i);this.fight.draw(t,Math.floor(t.canvas.width/2-h/2),120-n/2)}drawRound(t){if(this.drawControl.round)return;const i=u.fighters.reduce((h,n)=>n.rounds+h,0)+1;this.drawFrame(t,`round-${i}`,Math.floor(t.canvas.width/2-39),120-9)}drawRaiden(t){this.raiden.draw(t,Math.floor(t.canvas.width/2-59),Math.floor(t.canvas.height/2-50))}drawLiuKang(t){this.liuKang.draw(t,Math.floor(t.canvas.width/2-70),Math.floor(t.canvas.height/2-50))}updateWinner(t){const i=N();if(i)switch(i.id){case I.RAIDEN:return this.raiden.update(t);case I["LIU-KANG"]:return this.liuKang.update(t)}}drawWinner(t){const i=N();if(i)switch(i.id){case I.RAIDEN:return this.drawRaiden(t);case I["LIU-KANG"]:return this.drawLiuKang(t)}}draw(t){this.drawRound(t),this.drawFight(t),this.drawWinner(t)}}const yt=50*$;class x{constructor(){r(this,"image");r(this,"time",99);r(this,"timeTimer",0);r(this,"frames",new Map([["health-bar",[5406,49,163,12]],["health-damage-bar",[5407,64,135,10]],["round-score",[5406,79,11,16]],["raiden-wins",[3816,126,118,18]],["raiden-tag",[934,1026,45,11]],["liu-kang-wins",[3807,178,139,18]],["liu-kang-tag",[1e3,1026,59,11]],["time-0",[5756,34,8,16]],["time-1",[5766,34,9,16]],["time-2",[5777,34,9,16]],["time-3",[5788,34,9,16]],["time-4",[5799,34,8,16]],["time-5",[5809,34,9,16]],["time-6",[5820,34,8,16]],["time-7",[5830,34,8,16]],["time-8",[5840,34,9,16]],["time-9",[5851,34,8,16]]]));r(this,"names");r(this,"healthPoints",new Map([[u.fighters[0].playerId,u.fighters[0].healthPoints],[u.fighters[1].playerId,u.fighters[1].healthPoints]]));const t=document.querySelector('img[alt="misc"]');this.image=t,this.names=u.fighters.map(({id:i})=>`${i}-tag`)}drawFrame(t,i,h,n,o=1,l,m){U(t,this.image,this.frames.get(i),h,n,o,l,m)}update(t,i){this.updateTime(i),this.updateHealthBar(i)}updateHealthBar(t){for(const i of u.fighters){const h=this.healthPoints.get(i.playerId);i.healthPoints<h&&this.healthPoints.set(i.playerId,Math.max(0,h-t.secondsPassed*60))}}updateTime(t){t.previous>this.timeTimer+yt&&(this.time>0&&(this.time-=1),this.timeTimer=t.previous)}drawHealthBars(t){const i=Array.from(this.healthPoints.values());this.drawFrame(t,"health-bar",5,16,1,T+2,10),this.drawFrame(t,"health-damage-bar",6,17,1,T-i[0],8),this.drawFrame(t,"health-bar",t.canvas.width-5,16,-1,T+2,10),this.drawFrame(t,"health-damage-bar",t.canvas.width-6,17,-1,T-i[1],8)}drawRoundScores(t){for(let i=0;i<u.fighters[0].rounds;i++)this.drawFrame(t,"round-score",(i+1)*10-5,25);for(let i=0;i<u.fighters[1].rounds;i++)this.drawFrame(t,"round-score",t.canvas.width-5-(i+1)*10,25)}drawTimer(t){const i=String(Math.max(this.time,0)).padStart(2,"00");this.drawFrame(t,`time-${i.charAt(0)}`,t.canvas.width/2-8,14),this.drawFrame(t,`time-${i.charAt(1)}`,t.canvas.width/2,14)}drawNameTags(t){const[i,h]=this.names;this.drawFrame(t,i,5,2),this.drawFrame(t,h,255,2)}draw(t){this.drawHealthBars(t),this.drawRoundScores(t),this.drawTimer(t),this.drawNameTags(t)}}class at{constructor(){r(this,"image",document.querySelector('img[alt="courtyard"]'));r(this,"frames",new Map([["platform",[227,952,640,104]],["throne",[320,588,447,126]],["throne-decoration",[414,357,259,83]],["floor",[10,1726,1033,98]],["guards",[188,1391,693,116]]]));r(this,"monks",new A(this.image,[["monks-1",[1344,38,625,41]],["monks-2",[1344,174,625,40]],["monks-3",[1344,311,625,40]],["monks-4",[1344,446,625,41]],["monks-5",[1344,582,625,41]],["monks-6",[1344,718,625,41]]],[["monks-1",9],["monks-2",9],["monks-3",9],["monks-4",9],["monks-5",9],["monks-6",9]]));r(this,"music",document.querySelector("audio#theme-courtyard"));this.playMusic()}playMusic(){this.music.volume=.2,this.music.currentTime=0,this.music.play()}update(t){this.monks.update(t)}drawFrame(t,i,h,n,o,l){U(t,this.image,this.frames.get(i),h,n,o,l)}draw(t,i){t.fillStyle="#68C0D0",t.fillRect(0,0,t.canvas.width,t.canvas.height),this.drawFrame(t,"throne-decoration",Math.floor(584-i.position.x),74-i.position.y),this.drawFrame(t,"throne",Math.floor(489-i.position.x),13-i.position.y),this.drawFrame(t,"platform",Math.floor(397-i.position.x),90-i.position.y),this.drawFrame(t,"floor",Math.floor(192-i.position.x),159-i.position.y),this.monks.draw(t,405-i.position.x,145-i.position.y),this.drawFrame(t,"guards",Math.floor(365-i.position.x),113-i.position.y)}}class Ut{constructor(){r(this,"fighters");r(this,"camera");r(this,"stage");r(this,"overlays",[new x]);r(this,"battleInfo",new st);r(this,"fighterDrawOrder",[0,1]);r(this,"fade",new b);r(this,"timer",0);this.stage=new at,this.startRound()}getFighterEntityClass(t){switch(t){case I.RAIDEN:return At;case I["LIU-KANG"]:return Tt;default:throw new Error("Unimplemented fighter entity request")}}getFighterEntity(t,i){const h=this.getFighterEntityClass(t.id);return new h(i,this.handleAttackHit.bind(this))}getFighterEntities(){const t=u.fighters.map(this.getFighterEntity.bind(this));return t[0].opponent=t[1],t[1].opponent=t[0],t}handleAttackHit(t,i,h){const n=u.fighters[i].healthPoints-Et[h].damage;u.fighters[i].healthPoints=Math.max(0,n),this.fighterDrawOrder=[t,i]}startRound(){this.fighters=this.getFighterEntities(),this.camera=new St({x:rt+y-160,y:16},this.fighters)}restartRound(t){if(t.previous<this.timer+5e3)return;const i=N(),h=ut();if(i&&h){if(i.rounds===2){u.currentScene=new dt,u.currentMenu=f.GAMEOVER,this.stage.music.pause();return}i.healthPoints=T,h.healthPoints=T,this.startRound(),this.fade.restart(),this.overlays[0]=new x,this.battleInfo=new st,this.stage=new at,this.timer=0}}restartOverlays(t,i){if(this.timer!==0)return;this.timer=i.previous,t.rounds+=1;const h=this.overlays[0].time;this.overlays[0]=new x,this.overlays[0].time=h,this.overlays[0].timeTimer=1/0}updateFighterWinner(t,i){for(const h of this.fighters)if(h.playerId===t.playerId){h.changeState(e.WIN,i),h.opponent.changeState(e.LOSE,i);return}}updateFighters(t,i){const h=N();if(h)this.updateFighterWinner(h,i),this.restartOverlays(h,i),this.restartRound(i);else if(this.overlays[0].time===0){const[n,o]=u.fighters;n.healthPoints>o.healthPoints?(o.healthPoints=0,this.restartOverlays(n,i),this.restartRound(i)):n.healthPoints<o.healthPoints&&(n.healthPoints=0,this.restartOverlays(o,i),this.restartRound(i))}for(const n of this.fighters)n.update(t,i,this.camera)}updateOverlays(t,i){for(const h of this.overlays)h.update(t,i)}update(t,i){this.fade.fadeIn?this.battleInfo.drawControl.fight&&this.battleInfo.drawControl.round?(this.updateFighters(t,i),this.camera.update(t,i),this.updateOverlays(t,i),this.stage.update(i),this.battleInfo.update(t,i)):this.battleInfo.update(t,i):this.fade.update()}drawFighters(t){for(const i of this.fighterDrawOrder)this.fighters[i].draw(t,this.camera)}drawOverlays(t){for(const i of this.overlays)i.draw(t)}draw(t){this.stage.draw(t,this.camera),this.drawFighters(t),this.drawOverlays(t),this.battleInfo.draw(t),this.fade.draw(t)}}class kt{constructor(){r(this,"image",document.querySelector('img[alt="main-menu"]'));r(this,"frames",new Map([["text",[574,714,156,14]],["background",[790,686,320,240]],["raiden",[328,804,40,60]],["liu-kang",[371,804,40,60]]]));r(this,"fighters",[{id:I.RAIDEN,x:88,y:118},{id:I["LIU-KANG"],x:138,y:118}]);r(this,"playerOneFighter",0);r(this,"playerTwoFighter",1);r(this,"playerOne",new A(this.image,[["player-one-1",[1147,734,46,65]],["player-one-2",[1197,734,46,65]]],[["player-one-1",11],["player-one-2",11]]));r(this,"playerTwo",new A(this.image,[["player-two-1",[1147,802,46,65]],["player-two-2",[1197,802,46,65]]],[["player-two-1",11],["player-two-2",11]]));r(this,"fade",new b)}handlePrevFighter(t){return t>0?t-1:this.fighters.length-1}handleNextFighter(t){return t<this.fighters.length-1?t+1:0}updatePlayerFighter(){u.fighters[0]?R(D.SECOND,c.LEFT)?this.playerTwoFighter=this.handlePrevFighter(this.playerTwoFighter):R(D.SECOND,c.RIGHT)?this.playerTwoFighter=this.handleNextFighter(this.playerTwoFighter):_("Enter")&&(u.fighters[1]=tt(this.fighters[this.playerTwoFighter].id,D.SECOND),u.currentScene=new Ut,document.querySelector("audio#main-theme").pause()):R(D.FIRST,c.LEFT)?this.playerOneFighter=this.handlePrevFighter(this.playerOneFighter):R(D.FIRST,c.RIGHT)?this.playerOneFighter=this.handleNextFighter(this.playerOneFighter):_("Enter")&&(u.fighters[0]=tt(this.fighters[this.playerOneFighter].id,D.FIRST))}update(t){this.fade.fadeIn?(this.updatePlayerFighter(),u.fighters[0]?this.playerTwo.update(t):this.playerOne.update(t)):this.fade.update()}drawFrame(t,i,h,n,o,l){U(t,this.image,this.frames.get(i),h,n,o,l)}drawFightersSelected(t){const i=this.fighters[this.playerOneFighter],h=this.fighters[this.playerTwoFighter];u.fighters[0]?this.playerTwo.draw(t,h.x,h.y):this.playerOne.draw(t,i.x,i.y)}drawFighters(t){this.drawFrame(t,"raiden",90,120),this.drawFrame(t,"liu-kang",140,120)}draw(t){this.drawFrame(t,"background",0,0),this.drawFrame(t,"text",Math.floor(t.canvas.width/2-78),10),this.drawFighters(t),this.drawFightersSelected(t),this.fade.draw(t)}}class _t{constructor(){r(this,"image",document.querySelector('img[alt="main-menu"]'));r(this,"frames",new Map([["background",[1056,178,320,240]],["logo",[827,253,187,93]],["logo-border",[272,240,240,116]],["tablet",[807,360,226,93]]]));r(this,"startButton",new A(this.image,[["start-button-1",[560,367,85,59]],["start-button-2",[296,367,85,59]]],[["start-button-1",24],["start-button-2",24]]));r(this,"fade",new b)}update(t){this.fade.fadeIn?(_("Enter")&&(u.currentMenu=f.HEROES),this.startButton.update(t)):this.fade.update()}drawFrame(t,i,h,n,o,l){U(t,this.image,this.frames.get(i),h,n,o,l)}draw(t){this.drawFrame(t,"background",0,0,t.canvas.width,t.canvas.height),this.drawFrame(t,"logo",Math.floor(t.canvas.width/2-93.5),18),this.drawFrame(t,"logo-border",Math.floor(t.canvas.width/2-120),5),this.drawFrame(t,"tablet",Math.floor(t.canvas.width/2-113),133),this.startButton.draw(t,Math.floor(t.canvas.width/2-42.5),150),this.fade.draw(t)}}class dt{constructor(){r(this,"menus",{[f.MAIN]:new _t,[f.HEROES]:new kt,[f.GAMEOVER]:new Lt});r(this,"music");r(this,"musicStart",!1);r(this,"menuMusic",new Map([[f.MAIN,document.querySelector("audio#main-theme")],[f.HEROES,document.querySelector("audio#main-theme")],[f.GAMEOVER,document.querySelector("audio#theme-gameover")]]));r(this,"musicId")}playMusic(){this.music=this.menuMusic.get(u.currentMenu),this.musicId=u.currentMenu,this.music.volume=.2,this.music.currentTime=0,this.music.play(),this.musicStart=!0}resetMusic(){this.music.currentTime=0,this.musicStart=!1,this.music.pause()}update(t,i){this.music&&this.menuMusic.get(this.musicId)!==this.menuMusic.get(u.currentMenu)&&this.resetMusic(),this.musicStart||this.playMusic(),this.menus[u.currentMenu].update(i)}draw(t){this.menus[u.currentMenu].draw(t)}}const u={fighters:[],currentMenu:f.MAIN,currentScene:new dt};function N(){if(ut())return u.fighters.filter(s=>s.healthPoints>0)[0]}function ut(){return u.fighters.filter(t=>t.healthPoints===0)[0]}class Mt{constructor(){r(this,"context",pt());r(this,"frameTime",{secondsPassed:0,previous:0})}frame(t){this.frameTime.secondsPassed=(t-this.frameTime.previous)/1e3,this.frameTime.previous=t,this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),u.currentScene.update(this.context,this.frameTime),u.currentScene.draw(this.context),requestAnimationFrame(this.frame.bind(this))}start(){gt(),requestAnimationFrame(this.frame.bind(this))}}window.addEventListener("load",function(){this.window.addEventListener("click",function(){new Mt().start()},{once:!0})});
